<!doctype html>
<html>
   <head>
      <meta charset="UTF-8" />
      <title>User-defined functions | ReachVariantTool Documentation</title>
      <base href="../" />
      <link rel="stylesheet" href="resources/main.css" />
      <noscript>
         <link rel="stylesheet" href="resources/noscript.css" />
      </noscript>
   </head>
   <body>
      <nav id="sidebar">
         <ul>
            <li><a href="index.html">Index</a></li>
            <li>
               <a href="editor/main_window/index.html">Main Window</a>
               <ul>
                  <li><a href="editor/main_window/metadata.html">Metadata</a></li>
                  <li><a href="editor/main_window/options-general.html">General Settings</a></li>
                  <li><a href="editor/main_window/options-respawn.html">Respawn Settings</a></li>
                  <li><a href="editor/main_window/options-social.html">Social Settings</a></li>
                  <li><a href="editor/main_window/options-map.html">Map and Game Settings</a></li>
                  <li><a href="editor/main_window/options-team.html">Team Settings</a></li>
                  <li><a href="editor/main_window/options-loadout.html">Loadout Settings</a></li>
                  <li><a href="editor/main_window/options-megalo.html">Script-Specific Settings</a></li>
                  <li><a href="editor/main_window/option-visibility.html">Option Visibility</a></li>
                  <li><a href="editor/main_window/tu1.html">Title Update Settings</a></li>
                  <li><a href="editor/main_window/forge.html">Forge Settings</a></li>
               </ul>
            </li>
            <li>
               <a href="editor/script_window/index.html">Script Window</a>
               <ul>
                  <li><a href="editor/script_window/meta-strings.html">Metadata Strings</a></li>
                  <li><a href="editor/script_window/string-table.html">All Other Strings</a></li>
                  <li><a href="editor/script_window/forge-labels.html">Forge Labels</a></li>
                  <li><a href="editor/script_window/map-permissions.html">Map Permissions</a></li>
                  <li><a href="editor/script_window/player-rating-parameters.html">Player Rating Parameters</a></li>
                  <li><a href="editor/script_window/required-object-types.html">Required Object Types</a></li>
                  <li><a href="editor/script_window/script-options.html">Scripted Options</a></li>
                  <li><a href="editor/script_window/script-traits.html">Scripted Traits</a></li>
                  <li><a href="editor/script_window/script-stats.html">Scripted Stats</a></li>
                  <li><a href="editor/script_window/script-widgets.html">Scripted Widgets</a></li>
                  <li><a href="editor/script_window/gametype-code.html">Gametype Code</a></li>
               </ul>
            </li>
            <li>
               <a href="script/syntax.html">Scripting Language</a>
               <ul>
                  <li><a href="script/alias.html">Aliases</a></li>
                  <li><a href="script/events.html">Events</a></li>
                  <li><a href="script/for.html">For-each-loops</a></li>
                  <li><a href="script/if.html">If-/alt-statements</a></li>
                  <li><a href="script/operators.html">Operators</a></li>
                  <li><a href="script/enum.html">User-defined enums</a></li>
                  <li><a href="script/function.html">User-defined functions</a></li>
               </ul>
            </li>
            <li>
               <a href="script/api/index.html">Script API reference</a>
               <ul>
                  <li>
                     <a>Namespaces</a>
                     <ul>
                        <li><a href="script/api/ns_unnamed.html">Unnamed</a></li>
                        <li><a href="script/api/ns_enums.html">enums</a></li>
                        <li><a href="script/api/ns_game.html">game</a></li>
                        <li><a href="script/api/ns_global.html">global</a></li>
                     </ul>
                  </li>
                  <li>
                     <a>Types</a>
                     <ul>
                        <li>
                           <a>Variables</a>
                           <ul>
                              <li><a href="script/api/number.html">Number</a></li>
                              <li><a href="script/api/object.html">Object</a></li>
                              <li><a href="script/api/player.html">Player</a></li>
                              <li><a href="script/api/team.html">Team</a></li>
                              <li><a href="script/api/timer.html">Timer</a></li>
                           </ul>
                        </li>
                        <li>
                           <a>Misc</a>
                           <ul>
                              <li><a href="script/api/bool.html">Bool</a></li>
                              <li><a href="script/api/engine-icon.html">Engine Icon</a></li>
                              <li><a href="script/api/forge-label.html">Forge Label</a></li>
                              <li><a href="script/api/format-string.html">Format String</a></li>
                              <li><a href="script/api/object-type.html">Object Type</a></li>
                              <li><a href="script/api/player-set.html">Player Set</a></li>
                              <li><a href="script/api/variant-string-id.html">Variant ID</a></li>
                              <li><a href="script/api/waypoint-icon.html">Waypoint Icon</a></li>
                              <li><a href="script/api/widget.html">Widget</a></li>
                              <li><a href="script/api/widget-icon.html">Widget Icon</a></li>
                           </ul>
                        </li>
                     </ul>
                  </li>
               </ul>
            </li>
         </ul>
      </nav>
      <main>
         <h1>User-defined functions</h1>

      <p>
         Megalo's bytecode supports <dfn>user-defined functions</dfn>: reusable pieces of 
         script code that can be "called" from multiple different locations. User-defined 
         functions are useful for avoiding code duplication, if you have tasks that need 
         to be performed consistently at different points in your script; they are also a 
         good way to repeat tasks.
      </p>
      <p>
         User-defined functions run with the "environment" of their caller. For example, 
         a user-defined function called from inside of a <a href="script/for.html">for each object</a> 
         loop can access the <var>current_object</var> value. User-defined functions can't 
         take arguments or return values.
      </p>
      <p>
         This code sample creates five skulls and pushes them upward semi-randomly:
      </p>
      <pre>
--
-- Define the function:
--
function my_cool_code()
   global.object[1] = global.object[0].place_at_me(skull, none, none, 0, 0, 0, none)
   global.object[1].push_upward()
   global.object[1].push_upward()
end

--
-- Call the function five times:
--
my_cool_code()
my_cool_code()
my_cool_code()
my_cool_code()
my_cool_code()</pre>
      
      <h2>Recursion</h2>
      <p>
         User-defined functions can be <dfn>recursive</dfn>: that is, they can call themselves 
         in order to run under specific conditions:
      </p>
      <pre>
--
-- This function will perform a task "global.number[0]" many times:
--
function spawn_skulls()
   global.object[1] = global.object[0].place_at_me(skull, none, none, 0, 0, 0, none)
   global.object[1].push_upward()
   global.object[1].push_upward()
   --
   global.number[0] -= 1
   if global.number[0] > 0 then
      spawn_skulls()
   end
end

--
-- Let's spawn ten skulls:
--
global.number[0] = 10
spawn_skulls()

--
-- Let's spawn a random number of skulls:
--
global.number[0]  = rand(19)
global.number[0] += 1 -- ensure it's at least one
spawn_skulls()</pre>
      <p>
         When writing recursive functions, you need to be careful to ensure that the function 
         actually <em>ends</em>: there must be some circumstance under which the function 
         <em>does not</em> call itself anymore.
      </p>
      <p>
         Megalo doesn't have the ability to loop over a numeric range; however, as shown above, 
         recursive functions can be used as a substitute.
      </p>
      
      <h2>Availability</h2>
      <p>
         User-defined functions are supported by Megalo's bytecode &mdash; that is, the format 
         that Megalo is compiled into. However, they did not exist in Bungie's actual design 
         for the Megalo language. Nobody outside of Bungie and 343 Industries has ever seen 
         Megalo in its "true" form, but in the past, Bungie described the language as being 
         similar to BASIC, with no loops, functions, or other jumps.
      </p>
      <p>
         As such, you won't see user-defined functions in official content, and other 
         community-made tools made for Halo: Reach may fail to handle them properly. As far 
         as I am aware, user-defined functions are entirely new to ReachVariantTool.
      </p>
   
      </main>
      <script src="resources/sidebar.js"></script>
   </body>
</html>