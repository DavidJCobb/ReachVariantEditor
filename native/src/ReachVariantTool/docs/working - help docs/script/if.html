<!doctype html>
<html>
   <head>
      <meta charset="UTF-8" />
      <title>If-statements | ReachVariantTool Documentation</title>
      <base href="../" />
      <link rel="stylesheet" href="resources/main.css" />
      <noscript>
         <link rel="stylesheet" href="resources/noscript.css" />
      </noscript>
   </head>
   <body>
      <nav id="sidebar">
         <ul>
            <li><a href="index.html">Index</a></li>
            <li>
               <a href="editor/main_window/index.html">Main Window</a>
               <ul>
                  <li><a href="editor/main_window/metadata.html">Metadata</a></li>
                  <li><a href="editor/main_window/options-general.html">General Settings</a></li>
                  <li><a href="editor/main_window/options-respawn.html">Respawn Settings</a></li>
                  <li><a href="editor/main_window/options-social.html">Social Settings</a></li>
                  <li><a href="editor/main_window/options-map.html">Map and Game Settings</a></li>
                  <li>
                     <a href="editor/main_window/options-team.html">Team Settings</a>
                     <ul>
                        <li><a href="editor/main_window/options-team-specific.html">Individual Team Settings</a></li>
                     </ul>
                  </li>
                  <li>
                     <a href="editor/main_window/options-loadout.html">Loadout Settings</a>
                     <ul>
                        <li><a href="editor/main_window/options-loadout-specific.html">Individual Loadout Settings</a></li>
                     </ul>
                  </li>
                  <li><a href="editor/main_window/options-megalo.html">Script-Specific Settings</a></li>
                  <li><a href="editor/main_window/option-visibility.html">Option Visibility</a></li>
                  <li><a href="editor/main_window/tu1.html">Title Update Settings</a></li>
                  <li><a href="editor/main_window/forge.html">Forge Settings</a></li>
               </ul>
            </li>
            <li>
               <a href="editor/script_window/index.html">Script Window</a>
               <ul>
                  <li><a href="editor/script_window/meta-strings.html">Metadata Strings</a></li>
                  <li><a href="editor/script_window/string-table.html">All Other Strings</a></li>
                  <li><a href="editor/script_window/forge-labels.html">Forge Labels</a></li>
                  <li><a href="editor/script_window/map-permissions.html">Map Permissions</a></li>
                  <li><a href="editor/script_window/player-rating-parameters.html">Player Rating Parameters</a></li>
                  <li><a href="editor/script_window/required-object-types.html">Required Object Types</a></li>
                  <li><a href="editor/script_window/script-options.html">Scripted Options</a></li>
                  <li><a href="editor/script_window/script-traits.html">Scripted Traits</a></li>
                  <li><a href="editor/script_window/script-stats.html">Scripted Stats</a></li>
                  <li><a href="editor/script_window/script-widgets.html">Scripted Widgets</a></li>
                  <li><a href="editor/script_window/gametype-code.html">Gametype Code</a></li>
               </ul>
            </li>
            <li>
               <a href="script/syntax.html">Scripting Language</a>
               <ul>
                  <li><a href="script/alias.html">Aliases</a></li>
                  <li><a href="script/events.html">Events</a></li>
                  <li><a href="script/for.html">For-each-loops</a></li>
                  <li><a href="script/if.html">If-/alt-statements</a></li>
                  <li><a href="script/operators.html">Operators</a></li>
                  <li><a href="script/enum.html">User-defined enums</a></li>
                  <li><a href="script/function.html">User-defined functions</a></li>
                  <li><a href="script/snippets.html">Useful code snippets</a></li>
               </ul>
            </li>
            <li>
               <a href="script/api/index.html">Script API reference</a>
               <ul>
                  <li>
                     <a>Namespaces</a>
                     <ul>
                        <li><a href="script/api/ns_unnamed.html">Content not in any namespace</a></li>
                        <li><a href="script/api/ns_enums.html">enums</a></li>
                        <li><a href="script/api/ns_game.html">game</a></li>
                        <li><a href="script/api/ns_global.html">global</a></li>
                     </ul>
                  </li>
                  <li>
                     <a>Types</a>
                     <ul>
                        <li>
                           <a>Variables</a>
                           <ul>
                              <li><a href="script/api/number.html">Number</a></li>
                              <li><a href="script/api/object.html">Object</a></li>
                              <li><a href="script/api/player.html">Player</a></li>
                              <li><a href="script/api/team.html">Team</a></li>
                              <li><a href="script/api/timer.html">Timer</a></li>
                           </ul>
                        </li>
                        <li>
                           <a>Misc</a>
                           <ul>
                              <li><a href="script/api/bool.html">Bool</a></li>
                              <li><a href="script/api/engine-icon.html">Engine Icon</a></li>
                              <li><a href="script/api/forge-label.html">Forge Label</a></li>
                              <li><a href="script/api/format-string.html">Format String</a></li>
                              <li><a href="script/api/object-type.html">Object Type</a></li>
                              <li><a href="script/api/player-set.html">Player Set</a></li>
                              <li><a href="script/api/variant-string-id.html">Variant ID</a></li>
                              <li><a href="script/api/waypoint-icon.html">Waypoint Icon</a></li>
                              <li><a href="script/api/widget.html">Widget</a></li>
                              <li><a href="script/api/widget-icon.html">Widget Icon</a></li>
                           </ul>
                        </li>
                     </ul>
                  </li>
               </ul>
            </li>
         </ul>
      </nav>
      <main>
         <h1>If-statements</h1>

      <p>
         If you want to run a piece of code only when certain conditions are met, you 
         should use an if-statement:
      </p>
      <pre>
<span class="keyword">for</span> each player <span class="keyword">do</span>
   <span class="keyword">if</span> current_player.team == team[0] <span class="keyword">then</span>
      <span class="comment">--</span>
      <span class="comment">-- ... do something ...</span>
      <span class="comment">--</span>
   <span class="keyword">end</span>
<span class="keyword">end</span></pre>
      <p>
         An if-statement typically consists of the word "if," followed by one or more 
         conditions. Each condition is either a comparison statement or a function call. 
         Conditions must be separated from each other by the word "or" or the word "and." 
         A condition may be prefixed with the word "not". After the conditions, you must 
         write the word "then".
      </p>
      <p>
         Conditions are executed in sequence. You cannot adjust the order of operations 
         e.g. by using parentheses. If you want to test an expression like "(<var>A</var> 
         and <var>B</var>) or (<var>C</var> and <var>D</var>)," then you have two options:
      </p>
      <ul>
         <li>
            Initialize a variable to 0. Set it to 1 if "<var>A</var> and <var>B</var>." Set 
            it to 1 if "<var>C</var> and <var>D</var>." If the variable is 1, then run your 
            code.
         </li>
         <li>
            Write two if-statements with your code duplicated inside of them. The first 
            if-statement should test "<var>A</var> and <var>B</var>." The second if-statement 
            should test not "<var>A</var> or not <var>B</var> and <var>C</var> and <var>D</var>."
         </li>
      </ul>
      
      <h2>Alt and alt-if</h2>
      <p>
         Megalo does not have any built-in "else" or "elseif" statements. However, the Megalo 
         dialect used by ReachVariantTool offers similar statements as a shortcut. The two 
         pieces of code below behave identically (in fact, the former compiles to the latter):
      </p>
      <pre>
<span class="keyword">if</span> x == 1 <span class="keyword">then</span>
   run_function_a()
altif y == 1 <span class="keyword">then</span>
   run_function_b()
<span class="keyword">alt</span>
   run_function_c()
<span class="keyword">end</span></pre>
      <pre>
<span class="keyword">if</span> x == 1 <span class="keyword">then</span>
   run_function_a()
<span class="keyword">end</span>
<span class="keyword">if</span> x != 1 <span class="keyword">and</span> y == 1 <span class="keyword">then</span>
   run_function_b()
<span class="keyword">end</span>
<span class="keyword">if</span> x != 1 <span class="keyword">and</span> y != 1 <span class="keyword">then</span>
   run_function_c()
<span class="keyword">end</span></pre>
      <p>
         The main difference between this construct and "else(if)" is that if, in our example 
         above, if <var>x</var> is initially 1 but <var>run_function_a</var> changes the value 
         of <var>x</var> to something other than 1, then both the "x is 1" and "x is not 1" 
         branches may be able to run.
      </p>
      <p>
         If you need your branches to be mutually exclusive as they would be in an "else(if)" 
         statement, then you will need to use a variable to maintain state:
      </p>
      <pre>
<span class="keyword">alias</span> ran_any = global.number[0]
ran_any = 0
<span class="keyword">if</span> x == 1 <span class="keyword">then</span>
   ran_any = 1
   run_function_a()
<span class="keyword">end</span>
<span class="keyword">if</span> ran_any == 0 <span class="keyword">then</span>
   <span class="keyword">if</span> y == 1 <span class="keyword">then</span>
      ran_any = 1
      run_function_b()
   <span class="keyword">end</span>
   <span class="keyword">if</span> ran_any == 0 <span class="keyword">then</span>
      <span class="keyword">if</span> y != 1 <span class="keyword">then</span>
         run_function_c()
      <span class="keyword">end</span>
   <span class="keyword">end</span>
<span class="keyword">end</span></pre>
      <p>
         The example above may be easier to read if you consider that else(if) statements can 
         be written as nested else and if statements:
      </p>
      <pre>
<span class="keyword">if</span> x == 1 <span class="keyword">then</span>
   run_function_a()
else
   <span class="keyword">if</span> y == 1 <span class="keyword">then</span>
      run_function_b()
   else
      run_function_c()
   <span class="keyword">end</span>
<span class="keyword">end</span></pre>
      
      <h2>Else and else-if</h2>
      <p>
         As mentioned in the section above, the Megalo script engine doesn't have any built-in 
         support for "else(if)" statements. It would be theoretically possible for the compiler 
         to support such statements by automating the workaround described above, but this has 
         not been implemented as of this writing, and it would come with some ugly limitations 
         involving the nesting of else(if) statements.
      </p>
      
      <h2>Micro-optimizations</h2>
      <p>
         In Megalo, most code blocks compile to a single "trigger," or compiled block. However, 
         if-statements are a common exception. Conditions can be compiled directly into their 
         containing blocks, and they act as a kind of conditional exit: the block stops running 
         early if the condition is not met. This means that if an if-statement is the last 
         element in its containing block, then it can be "inlined" into that block's compiled 
         trigger, but if the if-statement isn't the last element, then it has to be compiled as 
         a nested trigger.
      </p>
      <p>
         In other words: the following two pieces of code do the same thing, but the second one 
         uses one less trigger and so contributes less to script size limits:
      </p>
      <pre>
<span class="keyword">for</span> each player <span class="keyword">do</span>
   <span class="keyword">if</span> current_player.team == team[0] <span class="keyword">then</span>
      game.show_message_to(current_player, none, <span class="string">"Your objective is under attack!</span>")
   <span class="keyword">end</span>
   script_widget[0].set_visibility(current_player, true)
<span class="keyword">end</span></pre>
      <pre>
<span class="keyword">for</span> each player <span class="keyword">do</span>
   script_widget[0].set_visibility(current_player, true)
   <span class="keyword">if</span> current_player.team == team[0] <span class="keyword">then</span>
      game.show_message_to(current_player, none, <span class="string">"Your objective is under attack!</span>")
   <span class="keyword">end</span>
<span class="keyword">end</span></pre>
   
      </main>
      <script src="resources/sidebar.js"></script>
      <script src="resources/header-links.js"></script>
   </body>
</html>